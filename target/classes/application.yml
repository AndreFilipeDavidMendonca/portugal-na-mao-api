server:
  port: ${PORT:8085}

  # importante em plataformas tipo Vercel (proxy à frente)
  forward-headers-strategy: framework

  tomcat:
    max-swallow-size: 20MB


  servlet:
    session:
      tracking-modes: cookie

  compression:
    enabled: true
    min-response-size: 1024
    mime-types: application/json,text/plain,text/html,text/xml,text/css,application/javascript

spring:
  application:
    name: monumentos-proxy

  main:
    web-application-type: servlet

  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 20MB

  datasource:
    # em produção no Vercel vais pôr estes env vars
    url: ${JDBC_DATABASE_URL:jdbc:postgresql://localhost:5432/pt_dot}
    username: ${JDBC_DATABASE_USERNAME:ptdot_user}
    password: ${JDBC_DATABASE_PASSWORD:ptdot_pass}
    driver-class-name: org.postgresql.Driver

  jpa:
    hibernate:
      ddl-auto: ${HIBERNATE_DDL_AUTO:update}
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
    show-sql: ${SHOW_SQL:false}

  sql:
    init:
      mode: never

  cache:
    type: caffeine

app:
  geocoding:
    nominatim:
      base-url: ${NOMINATIM_BASE_URL:https://nominatim.openstreetmap.org}
      user-agent: "${NOMINATIM_USER_AGENT:pt-dot-app/1.0 (contact: dev@pt-dot.local)}"
    cache:
      ttl-seconds: 604800

logging:
  level:
    pt.dot.application.service: ${LOG_LEVEL_SERVICE:INFO}
    pt.dot.application.monumentos: ${LOG_LEVEL_MONUMENTOS:INFO}

ptdot:
  jwt:
    secret: ${PTDOT_JWT_SECRET:CHANGE_ME_TO_A_LONG_RANDOM_SECRET_32+_CHARS}
    issuer: ${PTDOT_JWT_ISSUER:ptdot}
    accessTokenMinutes: ${PTDOT_JWT_ACCESS_MINUTES:60}
  bootstrap:
    reset-pois: ${PTDOT_RESET_POIS:false}
    import-district-files: ${PTDOT_IMPORT_DISTRICT_FILES:false}
    sync-pois-from-csv: ${PTDOT_SYNC_POIS_FROM_CSV:false}

  sipa:
    pois-csv-path: ${PTDOT_SIPA_POIS_CSV_PATH:classpath:/sipa/pois.csv}
    poi-images-csv-path: ${PTDOT_SIPA_POI_IMAGES_CSV_PATH:classpath:/sipa/poi_images.csv}
    district-files-csv-path: ${PTDOT_SIPA_DISTRICT_FILES_CSV_PATH:classpath:/db/sipa/district_files.csv}